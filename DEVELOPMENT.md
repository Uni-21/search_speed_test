# 開発者向けガイド

## 問題データの管理

### 📝 平文での問題編集

問題の追加・編集は `src/data/pool-1.source.json` ファイルで行います：

```json
{
  "id": "q999",
  "prompt": "新しい問題文は？",
  "type": "text",
  "acceptedAnswers": ["答え1", "こたえ2", "answer3"],
  "tags": ["カテゴリ1", "カテゴリ2"]
}
```

### 🔧 ビルド時の自動ハッシュ化

- **開発時**: `src/data/pool-1.source.json` で平文編集
- **ビルド時**: 自動的に `src/data/pool-1.json` にハッシュ化されたデータを生成

### 📋 利用可能なコマンド

```bash
# 問題データを手動でハッシュ化
npm run hash-questions

# 開発サーバー起動（平文データを使用）
npm run dev

# プロダクションビルド（自動でハッシュ化→ビルド）
npm run build

# プロダクション確認
npm run preview
```

### 📁 ファイル構成

```
src/data/
├── pool-1.source.json  # 📝 開発用（平文・Git管理対象）
└── pool-1.json         # 🔒 本番用（ハッシュ化・Git無視対象）
```

### ⚙️ 正規化ルール

回答は以下のルールで正規化されてからハッシュ化されます：

1. **NFKC正規化** - Unicode正規化
2. **空白処理** - 前後の空白除去、連続空白を1つに統一
3. **句読点除去** - 。、！？全角空白を除去
4. **小文字化** - アルファベットを小文字に変換
5. **カナ統一** - カタカナをひらがなに変換

例：
- `"　東京　"` → `"東京"`
- `"Tokyo"` → `"tokyo"`
- `"ニャー"` → `"にゃー"`

### 🔍 回答の微調整方法

1. `src/data/pool-1.source.json` を編集
2. `npm run hash-questions` で確認
3. ログで正規化結果とハッシュ値を確認
4. 必要に応じて `acceptedAnswers` を追加・修正

これにより、開発時は平文で簡単に編集でき、プロダクションでは自動的にセキュアなハッシュ化データが使用されます！